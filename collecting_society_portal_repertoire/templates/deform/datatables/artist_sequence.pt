<tal:block metal:extend-macro="sequence"
           i18n:domain="collecting_society_portal_repertoire"
           tal:define="oid oid|field.oid;
                       name field.name;
                       title title|field.title;
                       min_len min_len|field.widget.min_len;
                       min_len min_len or 0;
                       max_len max_len|field.widget.max_len;
                       max_len max_len or 100000;
                       now_len len(subfields);
                       orderable orderable|field.widget.orderable;
                       orderable orderable and 1 or 0;
                       prototype field.widget.prototype(field)">

    <!-- datatable sequence-->
    <tal:block metal:fill-slot="init">
        <script>
            // init of datatable sequence
            var datatableSequence = new deform.DatatableSequence({
                oid: "${oid}",
                name: "${name}",
                title: "${title}",
                minLen: "${min_len}",
                maxLen: "${max_len}",
                proto: "${prototype}",
                api: "${api}/artists",
                unique: "code",
                actions: ['add', 'create', 'edit'],
                columns: [
                    {
                        name: "name",
                        title: "${_('Name')}",
                        data: "name",
                        className: "all",
                        orderable: true,
                        render: $.fn.dataTable.render.text(),
                        datatableSequence: {
                            position: "displayed",
                            widgetType: 'TextInputWidget',
                            footerSearch: true,
                            createShow: true,
                        }
                    },
                    {
                        name: "code",
                        title: "${_('Code')}",
                        data: "code",
                        orderable: true,
                        render: $.fn.dataTable.render.text(),
                        datatableSequence: {
                            position: "displayed",
                            widgetType: 'HiddenWidget',
                            footerSearch: true,
                        }
                    },
                    {
                        name: "description",
                        title: "${_('Description')}",
                        data: "description",
                        className: "none",
                        orderable: false,
                        searchable: true,
                        render: $.fn.dataTable.render.text(),
                        datatableSequence: {
                            position: "collapsed",
                            widgetType: 'HiddenWidget',
                        }
                    },
                    {
                        name: "email",
                        title: "${_('Email')}",
                        data: "email",
                        visible: false,
                        orderable: false,
                        searchable: false,
                        render: $.fn.dataTable.render.text(),
                        datatableSequence: {
                            position: "invisible",
                            widgetType: 'TextInputWidget',
                            createShow: true,
                        }
                    },
                ],
            }).init();
        </script>
    </tal:block>

</tal:block>
